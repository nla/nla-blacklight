pipeline {
  agent any

  stages {
    stage('Docker build and push') {
      steps {
        sh """
          docker build --label "quay.expires-after=12w" -t nla-registry-quay-quay.apps.dev-containers.nla.gov.au/nla/blacklight:${env.BRANCH_NAME.replace("/", "_")}-${env.BUILD_NUMBER} -f Dockerfile .
          docker image push nla-registry-quay-quay.apps.dev-containers.nla.gov.au/nla/blacklight:${env.BRANCH_NAME.replace("/", "_")}-${env.BUILD_NUMBER}
        """
      }
    }
  }
}

<% bento_decorate(item) do |item| %>
  <% dbid = '' %>
  <% dbid = "data-bibid=#{item.unique_id}" if is_catalogued?(item.link) %>
  <% atl_data = (is_catalogued?(item.link) ? "data-atl='yes'" : "data-atl='no'") %>

  <div class="bento-item clearfix mb-4"  <%= dbid %>  data-unique-id="<%= item.unique_id %>" <%= atl_data.html_safe %> >
    <% if item.format_str && item.link.present? && (item.link).include?('digital') %>
      <div class="pull-left" style="margin-right:10px">
        <img src="<%= item.format_str %>" class="img-responsive img-thumbnail" alt="">
      </div>
    <% end %>
    <%= render :partial => "bento_search/item_title", :object => item, :as => 'item', :locals => {} %>

    <div class="col">
      <dl class="document-metadata dl-invert row">
        <% if item.authors.present? %>
          <dt class="col-12 col-md-3">Authors:</dt>
          <dd class="col col-sm-9"><%= item.render_authors_list %></dd>
        <% end %>

        <% if item.abstract.present? %>
          <dt class="col-12 col-md-3">Summary:</dt>
          <dd class="col col-sm-9"><%= item.render_summary %></dd>
        <% end %>

        <% if item.has_source_info? %>
          <dt class="col-12 col-md-3">Source:</dt>
          <dd class="col col-sm-9"><%= item.render_source_info %></dd>
        <% end %>

        <% if item.any_present?(:publication_date, :year) %>
          <dt class="col-12 col-md-3">Published:</dt>
          <dd class="col col-sm-9"><%= item.display_date %></dd>
        <% end %>

        <% if item.other_links.present? %>
          <dt class="col-12 col-md-3">Other links:</dt>
          <dd class="col col-sm-9"><%= render :partial => "bento_search/link", :collection => item.other_links %></dd>
        <% end %>

        <% if item.link_is_fulltext?.present? && item.format_str.present? %>
          <dt class="col-12 col-md-3">Format:</dt>
          <dd class="col col-sm-9"><i class="fa fa-check" title="Full text" aria-hidden="true"></i> Full text <%= item.format_str.downcase %></dd>
        <% elsif !item.link_is_fulltext?.present? && item.format_str.present? && item.engine_id == "summon_bento" %>
          <dt class="col-12 col-md-3">Format:</dt>
          <dd class="col col-sm-9"><i class="fa fa-pencil" title="Citation only" aria-hidden="true"></i> Citation only</dd>
        <% end %>

        <% if is_catalogued?(item.link) %>
          <% if item.language_str.present? %>
            <dt class="col-12 col-md-3">Language:</dt>
            <dd class="col col-sm-9"><%= item.language_str %></dd>
          <% end %>

          <% if item.custom_data[:callnumber].present? %>
            <dt class="col-12 col-md-3">Call number:</dt>
            <dd class="col col-sm-9"><%= item.custom_data[:callnumber] %></dd>
          <% end %>
        <% end %>

        <% if item.custom_data[:finding_aid] %>
          <% item.custom_data.each do |key, value| %>
            <% unless key == :finding_aid %>
              <dt class="col-12 col-md-3"><%= key %></dt>
              <dd class="col col-sm-9"><%= bento_truncate(raw(value), length: 140) %></dd>
            <% end %>
          <% end %>
        <% end %>
      </dl>
    </div>
  </div>
<% end %>
